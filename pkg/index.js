const L=Math.PI*2,d=Math.PI/180,H=1e3*60*60*24,b=2440588,k=2451545;function K(t){return t.valueOf()/H-.5+b}function v(t){return new Date((t+.5-b)*H)}function y(t){return K(t)-k}const P=d*23.4397;function z(t,n){const{sin:e,cos:s,tan:o,atan2:r}=Math;return r(e(t)*s(P)-o(n)*e(P),s(t))}function I(t,n){const{asin:e,sin:s,cos:o}=Math;return e(s(n)*o(P)+o(n)*s(P)*s(t))}function E(t,n,e){const{atan2:s,sin:o,cos:r,tan:a}=Math;return s(o(t),r(t)*o(n)-a(e)*r(n))}function U(t,n,e){const{asin:s,sin:o,cos:r}=Math;return s(o(n)*o(e)+r(n)*r(e)*r(t))}function q(t,n){return d*(280.16+360.9856235*t)-n}function Q(t){const{tan:n}=Math;return t<0&&(t=0),2967e-7/n(t+.00312536/(t+.08901179))}function O(t){return d*(357.5291+.98560028*t)}function S(t){const{sin:n,PI:e}=Math,s=d*(1.9148*n(t)+.02*n(2*t)+3e-4*n(3*t)),o=d*102.9372;return t+s+o+e}function j(t){const n=O(t),e=S(n);return{dec:I(e,0),ra:z(e,0)}}export function getPosition(t,n,e){var s=d*-e,o=d*n,r=y(t),a=j(r),c=q(r,s)-a.ra;return{azimuth:E(c,o,a.dec),altitude:U(c,o,a.dec)}}export const times=[{angle:-.833,riseName:"sunrise",setName:"sunset"},{angle:-.3,riseName:"sunriseEnd",setName:"sunsetStart"},{angle:-6,riseName:"dawn",setName:"dusk"},{angle:-12,riseName:"nauticalDawn",setName:"nauticalDusk"},{angle:-18,riseName:"nightEnd",setName:"night"},{angle:6,riseName:"goldenHourEnd",setName:"goldenHour"}];export function addTime(t,n,e){times.push({angle:t,riseName:n,setName:e})}const F=9e-4;function V(t,n){const{round:e}=Math;return e(t-F-n/L)}function R(t,n,e){return F+(t+n)/L+e}function B(t,n,e){const{sin:s}=Math;return k+t+.0053*s(n)-.0069*s(2*e)}function W(t,n,e){const{sin:s,cos:o,acos:r}=Math;return r((s(t)-s(n)*s(e))/(o(n)*o(e)))}function X(t){return-2.076*Math.sqrt(t)/60}function Y(t,n,e,s,o,r,a){var c=W(t,e,s),i=R(c,n,o);return B(i,r,a)}export function getTimes(t,n,e,s){s=s||0;const o=d*-e,r=d*n,a=X(s),c=y(t),i=V(c,o),h=R(0,o,i),u=O(h),l=S(u),M=I(l,0),f=B(h,u,l);let g,N,w,D;const p={solarNoon:v(f),nadir:v(f-.5)};for(let m=0,J=times.length;m<J;m+=1)g=times[m],N=(g.angle+a)*d,w=Y(N,o,r,M,i,u,l),D=f-(w-f),p[g.riseName]=v(D),p[g.setName]=v(w);return p}function G(t){const{sin:n,cos:e}=Math;var s=d*(218.316+13.176396*t),o=d*(134.963+13.064993*t),r=d*(93.272+13.22935*t),a=s+d*6.289*n(o),c=d*5.128*n(r),i=385001-20905*e(o);return{ra:z(a,c),dec:I(a,c),dist:i}}export function getMoonPosition(t,n,e){const{atan2:s,sin:o,tan:r,cos:a}=Math,c=d*-e,i=d*n,h=y(t),u=G(h),l=q(h,c)-u.ra,M=s(o(l),r(i)*a(u.dec)-o(u.dec)*a(l));let f=U(l,i,u.dec);return f+=Q(f),{azimuth:E(l,i,u.dec),altitude:f,distance:u.dist,parallacticAngle:M}}export function getMoonIllumination(t){const{acos:n,sin:e,cos:s,atan2:o}=Math;var r=y(t||new Date),a=j(r),c=G(r),i=149598e3,h=n(e(a.dec)*e(c.dec)+s(a.dec)*s(c.dec)*s(a.ra-c.ra)),u=o(i*e(h),c.dist-i*s(h)),l=o(s(a.dec)*e(a.ra-c.ra),e(a.dec)*s(c.dec)-s(a.dec)*e(c.dec)*s(a.ra-c.ra));return{fraction:(1+s(u))/2,phase:.5+.5*u*(l<0?-1:1)/Math.PI,angle:l}}function A(t,n){return new Date(t.valueOf()+n*H/24)}export function getMoonTimes(t,n,e,s){const{sqrt:o,abs:r}=Math,a=new Date(t);s?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);const c=.133*d;let i=getMoonPosition(a,n,e).altitude-c,h,u,l,M,f,g,N,w,D,p,m,J,C;for(let x=1;x<=24&&(h=getMoonPosition(A(a,x),n,e).altitude-c,u=getMoonPosition(A(a,x+1),n,e).altitude-c,f=(i+u)/2-h,g=(u-i)/2,N=-g/(2*f),w=(f*N+g)*N+h,D=g*g-4*f*h,p=0,D>=0&&(C=o(D)/(r(f)*2),m=N-C,J=N+C,r(m)<=1&&p++,r(J)<=1&&p++,m<-1&&(m=J)),p===1?i<0?l=x+m:M=x+m:p===2&&(l=x+(w<0?J:m),M=x+(w<0?m:J)),!(l&&M));x+=2)i=u;const T={};return l&&(T.rise=A(a,l)),M&&(T.set=A(a,M)),!l&&!M&&(T[w>0?"alwaysUp":"alwaysDown"]=!0),T}
//# sourceMappingURL=index.js.map
